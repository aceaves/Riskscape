input(relation: 'Census2023PopulationAtAddress.shp', name: 'exposure') as exposures_input
 -> select({exposure}) as exposures
 -> join(on: true) as exposures_join_hazards
 -> select({*, sample_one(geometry: exposure, coverage: hazard) as hazard}) as "sample_hazard_layer"
 -> select({*}) as sampled
 -> select({*, consequence: map(hazard, hv -> is_exposed(exposure, hv))})
 -> select({*}) as raw_results
 -> select({exposure, hazard, consequence}) as event_impact_table
input(value: bookmark('C:\2_Workspaces\Riskscape\Projects\Testing\\wMed_1000yr_MHWS_Zone73.tif'), name: 'hazard') as hazards_input
 -> select({hazard as hazard}) as hazards
 -> exposures_join_hazards.rhs
event_impact_table
 -> select({*}) as "report_event-impact"
 -> select({*, exposure.PropertyPo as PropertyPo})
 -> save(name: 'event-impact') as "save_event-impact"
event_impact_table
 -> select({*}) as "report_summary"
 -> group(by: {'Total' as Results}, select: {*, Depth."range_<_0_4".round_sum_PropertyPo + Depth."range_0_4_0_6".round_sum_PropertyPo + Depth."range_0_6_0_8".round_sum_PropertyPo + Depth."range_0_8_1_2".round_sum_PropertyPo + Depth."range_1_2_+".round_sum_PropertyPo as Number_Exposed, round(sum(exposure.PropertyPo)) as Total_Population, bucket_range(pick: hazard, select: {round(sum(exposure.PropertyPo))}, range: [0.4, 0.6, 0.8, 1.2]) as Depth})
 -> save(name: 'summary', format: 'csv') as "save_summary"